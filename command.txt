sudo su

#mongodb
sudo apt-get install gnupg curl
curl -fsSL https://www.mongodb.org/static/pgp/server-7.0.asc | \zsudo gpg -o /usr/share/keyrings/mongodb-server-7.0.gpg \ --dearmor
echo "deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-7.0.gpg ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-7.0.list
sudo apt-get update
sudo apt-get install -y mongodb-org
echo "mongodb-org hold" | sudo dpkg --set-selections
echo "mongodb-org-database hold" | sudo dpkg --set-selections
echo "mongodb-org-server hold" | sudo dpkg --set-selections
echo "mongodb-mongosh hold" | sudo dpkg --set-selections
echo "mongodb-org-mongos hold" | sudo dpkg --set-selections
echo "mongodb-org-tools hold" | sudo dpkg --set-selections
ps --no-headers -o comm 1

sudo systemctl start mongod
sudo systemctl daemon-reload
sudo systemctl status mongod
sudo systemctl enable mongod
sudo systemctl stop mongod
sudo systemctl restart mongod
mongosh


sudo apt-get update
sudo apt-get install python3-venv
sudo apt-get install python3-pip
python3 -m venv venv
source venv/bin/activate
git clone 'https://github.com/ramesh000002/flask-deployment.git'

pip install -r requirement.txt
python3 application.py
sudo nano application.py
cat application.py

pip install gunicorn
gunicorn -b 0.0.0.0:8000 application:application

sudo nano /etc/systemd/system/flaskapp.service
[Unit]
Description=Gunicorn instance for a simple flask app
After=network.target
[Service]
User=ubuntu
Group=www-data
WorkingDirectory=/home/ubuntu/flask-deployment
ExecStart=/home/ubuntu/flask-deployment/venv/bin/gunicorn -b localhost:8000 application:application
Restart=always
[Install]
WantedBy=multi-user.target

sudo systemctl daemon-reload
sudo systemctl start flaskapp
sudo systemctl enable flaskapp

curl localhost:8000
sudo apt-get intall nginx
sudo systemctl start nginx
sudo systemctl enable nginx

sudo nano /etc/nginx/sites-available/default

upstream flaskapp {
    server 127.0.0.1:8000;
}

location / {
    proxy_pass http://flaskapp;
}

sudo systemctl restart nginx
